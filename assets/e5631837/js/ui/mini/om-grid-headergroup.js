(function(e){function t(e,t){var n=e._getColModel();for(var r=0,i=n.length;r<i;r++)if(n[r].name==t.name)return r}function n(e,t,n){var r=0;e.push(n.replace(/\$/g,function(){return t[r++]}))}function r(e){e._colModel=[];var t=e._getColModel(),n=[],r=[],s=1,o=1,u,a,f,l=t.length;for(var c=0;c<l;c++)n[c]=[];for(var c=0,h=l;c<h;c++){u=t[c];for(var p=0,d=u.length;p<d;p++)a=u[p],s=a.rowspan||1,o=a.colspan||1,f=i(n,c,s,o),a.name&&r.push({header:a,colIndex:f})}r.sort(function(e,t){return e.colIndex-t.colIndex}),c=0;while(r[c]&&e._colModel.push(r[c++].header));}function i(e,t,n,r){var i=0;while(e[t][i]&&++i);for(var s=t;s<t+n;s++)for(var o=i;o<i+r;o++)e[s][o]=!0;return i}e.omWidget.addBeforeInitListener("om.omGrid",function(){var i=this._getColModel();if(!e.isArray(i)||i.length<=0||!e.isArray(i[0]))return;r(this),this.hDiv.addClass("hDiv-group-header"),e.extend(this,{_getColModel:function(){return this._colModel},_getHeaderCols:function(){var t=[],n=this.options,r=this.hDiv,i=r.find("th[axis^='col']");return e(i).each(function(){t.push(this)}),t.sort(function(e,t){return e.axis.slice(3)-t.axis.slice(3)}),!n.singleSelect&&t.unshift(r.find("th[axis='checkboxCol']")[0]),n.showIndex&&t.unshift(r.find("th[axis='indexCol']")[0]),n.rowDetailsProvider&&t.unshift(r.find("th[axis='expenderCol']")[0]),e(t)},_buildTableHead:function(){var r=this.options,i=this.element,s=i.closest(".om-grid"),o=r.colModel,u=0,a=-1,f="<th class='$' $ $ $ $ $><div class='$' style='text-align:$; $'>$</div></th>",l=["<thead>"],c,h,p,d;for(var v=0,m=o.length;v<m;v++){l.push("<tr>"),v==0&&(r.showIndex&&l.push("<th class='indexCol data-header-"+m+"' align='center' axis='indexCol' rowspan="+m+"><div class='indexheader' style='text-align:center;width:25px;' /></th>"),r.singleSelect||l.push("<th class='checkboxCol data-header-"+m+"' align='center' axis='checkboxCol' rowspan="+m+"><div class='checkboxheader' style='text-align:center;width:17px;'><span class='checkbox'/></div></th>")),p=o[v];for(var g=0,y=p.length;g<y;g++){h=p[g];var b=h.width||60,w=h.align||"center",E=h.name;h.name&&b=="autoExpand"&&(b=0,a=t(this,h));var S=h.wrap?"wrap":"";S+=(h.name?" data-header-":" group-header-")+(h.rowspan?h.rowspan:1),c=[S,h.align?"align="+h.align:"",E?"axis=col"+t(this,h):"",E?"abbr="+E:"",h.rowspan?"rowspan="+h.rowspan:"",h.colspan?"colspan="+h.colspan:"",h.wrap?"wrap":"",w,E?"width:"+b+"px":"",h.header],n(l,c,f),h.name&&(u+=b)}l.push("</tr>")}l.push("</thead>"),e("table",this.hDiv).html(l.join("")),d=e("thead",this.hDiv),this._fixHeaderWidth(a,u),this.thead=d,d=null}})})})(jQuery);