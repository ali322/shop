(function(e){e.omWidget("om.omScrollbar",{options:{thick:8},_create:function(){var t=this.options;this._vScrollbar=e("<div class='om-widget om-scrollbar om-corner-all'></div>").width(t.thick).appendTo("body").hide(),this._vScrollbar.type="v",this._hScrollbar=e("<div class='om-widget om-scrollbar om-corner-all'></div>").height(t.thick).appendTo("body").hide(),this._hScrollbar.type="h"},_init:function(){this.element.css("overflow","hidden"),this._buildEvent()},destroy:function(){this._vScrollbar.remove(),this._hScrollbar.remove()},_buildEvent:function(){var t=this,n=this.element,r=[this._vScrollbar,this._hScrollbar];e(r).each(function(i,s){s._hover=!1,s._enable=!0;var o=s.type,u=0;s.omDraggable({axis:o==="v"?"y":"x",containment:n,onStart:function(e,t){u=o==="v"?n.scrollTop():n.scrollLeft()},onDrag:function(e,r){var i=e.position,a=e.originalPosition;o=="v"?n.scrollTop(u+t._getInt((i.top-a.top)*n.innerHeight()/s.outerHeight())):n.scrollLeft(u+t._getInt((i.left-a.left)*n.innerWidth()/s.outerWidth()))}}).hover(function(){e(r).each(function(e,t){t._hover=!0,clearTimeout(t._timer)}),e(this).addClass("scrollbar-state-hover")},function(){e(r).each(function(e,n){n._hover=!1,t._setTimer(n.type)}),e(this).removeClass("scrollbar-state-hover")})});var i=e.browser.mozilla?"DOMMouseScroll":"mousewheel";n.bind(i,function(e){t._mousewheelListener.call(t,e)}),e(r).each(function(e,n){n.bind(i,function(e){t._mousewheelListener.call(t,e)})}),n.hover(function(){e(r).each(function(e,n){n._hover=!0,clearTimeout(n._timer),t._resize(n),n._enable&&n.fadeIn("fast")})},function(){e(r).each(function(e,n){n._hover=!1,t._setTimer(n.type)})})},_mousewheelListener:function(e){var t=this;if(!t._vScrollbar._enable)return;var n=0;e.wheelDelta?n=-e.wheelDelta:n=e.detail*40;var r=n/120*10,i=t._vScrollbar,s=t.element,o=s.offset().top+t._getInt(s.css("border-top-width"))+t._getInt(s.css("padding-top"))+t._getInt(s.css("padding-top-width")),u=i.position().top-o,a=s.height(),f=a-i.outerHeight();r+u<0?(i.css("top",o),s.scrollTop(0)):r+u>f?(i.css("top",o+f),s.scrollTop(s[0].scrollHeight-s.height())):(i.css("top","+="+r),s.scrollTop(s.scrollTop()+parseInt(r*s.innerHeight()/i.outerHeight()))),e.preventDefault()},_getScrollbar:function(e){return"h"===e?this._hScrollbar:this._vScrollbar},_setTimer:function(e){var t=this;clearTimeout(this._getScrollbar(e)._timer),function(e){setTimeout(function(){var n=t._getScrollbar(e);n._hover||n.fadeOut("fast")},200)}(e)},refresh:function(){var t=[this._vScrollbar,this._hScrollbar],n=this;e(t).each(function(e,t){n._resize(t)})},_resize:function(e){var t=this.element,n=e.type,r=0,i=t.offset(),s=t.width(),o=t.height(),u=t.outerWidth(),a=t.outerHeight(),f=this._getInt(t.css("border-left-width")),l=this._getInt(t.css("border-right-width")),c=this._getInt(t.css("border-top-width")),h=this._getInt(t.css("border-bottom-width")),p=this._getInt(t.css("padding-left")),d=this._getInt(t.css("padding-top"));"v"===n?(r=t[0].scrollHeight,r>o?(e._enable=!0,e.outerHeight(this._getInt(o*t.innerHeight()/r)),e.css({left:i.left+u-e.outerWidth()-l,top:i.top+c+d+this._getInt(t.scrollTop()*o/r)})):e._enable=!1):"h"===n&&(r=t[0].scrollWidth,r>t.innerWidth()?(e._enable=!0,e.outerWidth(this._getInt((p+s)*s/r)),e.css({left:i.left+f+p+this._getInt(t.scrollLeft()*s/r),top:i.top+a-e.outerHeight()-h})):e._enable=!1),e._enable?e.fadeIn("fast"):e.fadeOut("fast")},_getInt:function(e){return parseInt(e)||0}})})(jQuery);