(function(e){e.omWidget("om.omBorderLayout",{options:{fit:!1,spacing:5,hideCollapsBtn:!1,onBeforeDrag:function(e,t){},onAfterDrag:function(e,t){}},_create:function(){if(!this.options.panels)return;this._minWidth=50,this._minHeight=28,this._buildRegion(),this._resizeRegion(!0),e(window).resize(e.proxy(this,"_resizeRegion"))},_getRegionSize:function(e){var t=this._getRegion(e),n=this._getRegionProxy(e),r={};return r.width=this._regionVisible(t)?t.outerWidth(!0):this._regionVisible(n)?n.outerWidth(!0):0,r.height=this._regionVisible(t)?t.outerHeight(!0):this._regionVisible(n)?n.outerHeight(!0):0,r},_resizeRegion:function(e){var t=this._getRegion("center"),n=this._getRegion("north"),r=this._getRegion("south"),i=this._getRegion("west"),s=this._getRegion("east"),o=this._getRegionProxy("north"),u=this._getRegionProxy("south"),a=this._getRegionProxy("west"),f=this._getRegionProxy("east"),l=this._getRegionSize("north").height;southHeight=this._getRegionSize("south").height,westWidth=this._getRegionSize("west").width,eastWidth=this._getRegionSize("east").width,centerWidth=this._getRegionSize("center").width,layoutWidth=this.element.width(),layoutHeight=this.element.height(),westOpt=this._getPanelOpts("west"),eastOpt=this._getPanelOpts("east"),t.css({top:l,left:westWidth}),t.find(">.om-panel-body").omPanel("resize",{height:layoutHeight-l-southHeight}),e||t.find(">.om-panel-body").omPanel("resize",{width:layoutWidth-westWidth-eastWidth});var c=t.outerHeight(!0);if(n){var h=layoutWidth-(westOpt.expandToTop?westWidth:0)-(eastOpt.expandToTop?eastWidth:0);n.find(">.om-panel-body").omPanel("resize",{width:h}),n.css({left:westOpt.expandToTop?westWidth:0}),o&&o.outerWidth(h).css({left:westOpt.expandToTop?westWidth:0})}if(r){var p=layoutWidth-(westOpt.expandToBottom?westWidth:0)-(eastOpt.expandToBottom?eastWidth:0);r.find(">.om-panel-body").omPanel("resize",{width:p}),r.css({top:layoutHeight-r.outerHeight(!0),left:westOpt.expandToBottom?westWidth:0}),u&&u.outerWidth(p).css({left:westOpt.expandToBottom?westWidth:0})}if(i){var d=westOpt.expandToTop?0:l,v=c+(westOpt.expandToBottom?southHeight:0)+(westOpt.expandToTop?l:0);i.css({top:d}),i.find(">.om-panel-body").omPanel("resize",{height:v}),a&&(a.css({top:d}),a.outerHeight(v))}if(s){var m=eastOpt.expandToTop?0:l,g=c+(eastOpt.expandToBottom?southHeight:0)+(eastOpt.expandToTop?l:0);s.css({top:m}),s.find(">.om-panel-body").omPanel("resize",{height:g}),f&&(f.css({top:m}),f.outerHeight(g))}if(e){var y=this._getPanelOpts("east")&&!this._getPanelOpts("east").width,b=this._getPanelOpts("west")&&!this._getPanelOpts("west").width,w=!this._getPanelOpts("center").width;if(y||b||w)!w&&y&&b?eastWidth=westWidth=(layoutWidth-centerWidth)/2:w&&!y&&b?centerWidth=westWidth=(layoutWidth-eastWidth)/2:w&&y&&!b?centerWidth=eastWidth=(layoutWidth-westWidth)/2:w&&y&&b&&(eastWidth=westWidth=centerWidth=layoutWidth/3);w&&t.find(">.om-panel-body").omPanel("resize",{width:Math.floor(layoutWidth-westWidth-eastWidth)}),y&&s.find(">.om-panel-body").omPanel("resize",{width:Math.ceil(layoutWidth-westWidth-centerWidth)-this.options.spacing}),b&&(i.find(">.om-panel-body").omPanel("resize",{width:Math.ceil(layoutWidth-eastWidth-centerWidth)-this.options.spacing}),t.css({left:i.width()+this.options.spacing}))}},_regionVisible:function(e){return e&&e.css("display")!="none"},_createRegionProxy:function(t,n){var r=this,i="";if(n){i='<div class="om-borderlayout-proxy om-borderlayout-trigger-proxy-'+t.region+'" proxy="'+t.region+'">'+'<div class="om-borderlayout-expand-trigger">'+"</div>"+"</div>";var s=e(i);t.region=="west"||t.region=="east"?s.width(r.options.spacing):(t.region=="north"||t.region=="south")&&s.height(r.options.spacing),function(e){s.find(".om-borderlayout-expand-trigger").click(function(){r.expandRegion(e.region)})}(t)}else{i='<div class="om-borderlayout-proxy om-borderlayout-proxy-'+t.region+'" proxy="'+t.region+'">'+'<div class="om-panel-title"></div>'+'<div class="om-panel-tool">'+'<div class="om-icon panel-tool-expand">'+"</div>"+"</div>"+"</div>";var s=e(i);(function(t){s.find(".panel-tool-expand").hover(function(){e(this).toggleClass("panel-tool-expand-hover")}).click(function(){r.expandRegion(t.region)})})(t)}s.hover(function(){e(this).toggleClass("om-borderlayout-proxy-hover")}).appendTo(this.element)},_buildRegion:function(){var t=this,n=this.element;this.element.addClass("om-borderlayout"),this.options.hideCollapsBtn&&this.element.addClass("om-borderlayout-hide-collaps-btn"),this.options.fit&&n.css({width:"100%",height:"100%"});for(var r=0;r<this.options.panels.length;r++){var i=e.extend({},this.options.panels[r]),s=this.element.find("#"+i.id),o=i.collapsible&&t.options.hideCollapsBtn;i.collapsible&&i.region!="center"&&this._createRegionProxy(i,o),i.collapsible&&(e.extend(i,{collapsible:!1}),t.options.hideCollapsBtn||e.extend(i,{tools:[{iconCls:["panel-tool-collapse","panel-tool-collapse-hover"],handler:function(e){t.collapseRegion(e.element.parent().attr("region"))}}]}));if(i.closable){var u=i.onClose;e.extend(i,{onClose:function(){u&&u.call(s[0]),t._resizeRegion()}})}s.omPanel(i),(i.region=="north"||i.region=="south")&&s.omPanel("resize",{width:n.width()});var a="0",f=this.options.spacing+"px";if(i.resizable&&i.region!="center"){var l="";handleClass={},i.region=="west"?(l="e",handleClass.width=f,handleClass.right="-"+f):i.region=="east"?(l="w",handleClass.width=f,handleClass.left="-"+f):i.region=="south"?(l="n",handleClass.height=f,handleClass.top="-"+f):i.region=="north"&&(l="s",handleClass.height=f,handleClass.bottom="-"+f),s.parent().omResizable({handles:l,helper:"om-borderlayout-resizable-helper-"+l,stop:function(e,r){n.find(">.om-borderlayout-mask").remove(),e.element.find(">.om-panel-body").omPanel("resize",e.size),t._resizeRegion(),t.options.onAfterDrag&&t._trigger("onAfterDrag",null,e.element)},start:function(r,i){var s=r.element.omResizable("option","helper");e("body").find("."+s).css("border-width",t.options.spacing);var o=r.element.attr("region"),u=n.width()-2*t._minWidth,a=n.height()-2*t._minHeight;o=="west"?(u=n.width()-(t._getRegionSize("east").width+t._minWidth),r.element.omResizable("option","maxWidth",u)):o=="east"?(u=n.width()-(t._getRegionSize("west").width+t._minWidth),r.element.omResizable("option","maxWidth",u)):o=="north"?(a=n.height()-(t._getRegionSize("south").height+t._minHeight+t.options.spacing),r.element.omResizable("option","maxHeight",a)):o=="south"&&(a=n.height()-(t._getRegionSize("north").height+t._minHeight+t.options.spacing),r.element.omResizable("option","maxHeight",a)),e('<div class="om-borderlayout-mask"></div>').css({width:n.width(),height:n.height()}).appendTo(n),t.options.onBeforeDrag&&t._trigger("onBeforeDrag",null,r.element)},minWidth:t._minWidth,minHeight:t._minHeight}),s.parent().find(".om-resizable-handle").css(handleClass),a=(i.region=="south"?f:0)+" "+(i.region=="west"?f:0)+" "+(i.region=="north"?f:0)+" "+(i.region=="east"?f:0);if(o){var c=e("<div class='om-borderlayout-collaps-trigger-"+i.region+"'></div>");(function(e){c.click(function(){t.collapseRegion(e.attr("region"))})})(s.parent()),s.parent().find(".om-resizable-handle").append(c)}}s.parent().addClass("om-borderlayout-region").addClass("om-borderlayout-region-"+i.region).css("margin",a).attr("region",i.region),s.addClass("om-borderlayout-region-body"),s.prev().addClass("om-borderlayout-region-header")}},_getRegion:function(e){var t=this.element.find('>[region="'+e+'"]');return t.size()>0?t:!1},_getRegionProxy:function(e){var t=this.element.find('>[proxy="'+e+'"]');return t.size()>0?t:!1},_getPanelOpts:function(e){for(var t=0;t<this.options.panels.length;t++)if(e==this.options.panels[t].region)return this.options.panels[t];return!1},collapseRegion:function(t){var n=this._getPanelOpts(t);if(!n||!n.collapsible)return;var r=this._getRegion(t);$body=r.find(">.om-panel-body");if(r){var i=e.data($body[0],"omPanel");if(i.options.closed)return;if(n.onBeforeCollapse&&i._trigger("onBeforeCollapse")===!1)return!1;r.hide(),n.onCollapse&&i._trigger("onCollapse"),this._getRegionProxy(t).show(),this._resizeRegion()}},expandRegion:function(t){var n=this._getPanelOpts(t);if(!n||!n.collapsible)return;var r=this._getRegion(t);$body=r.find(">.om-panel-body");if(r){var i=e.data($body[0],"omPanel");if(i.options.closed)return;if(n.onBeforeExpand&&i._trigger("onBeforeExpand")===!1)return!1;r.show(),n.onExpand&&i._trigger("onExpand"),this._getRegionProxy(t).hide(),this._resizeRegion()}},closeRegion:function(t){var n=this._getPanelOpts(t);if(!n||!n.closable)return;var r=this._getRegion(t);$body=r.find(">.om-panel-body");if(r){var i=e.data($body[0],"omPanel");if(i.options.closed)return;r.find(">.om-panel-body").omPanel("close"),this._getRegionProxy(t).hide(),this._resizeRegion()}},openRegion:function(t){var n=this._getPanelOpts(t);if(!n||!n.closable)return;var r=this._getRegion(t);$body=r.find(">.om-panel-body");if(r){var i=e.data($body[0],"omPanel");if(!i.options.closed)return;r.find(">.om-panel-body").omPanel("open"),this._getRegionProxy(t).hide(),this._resizeRegion()}}})})(jQuery);